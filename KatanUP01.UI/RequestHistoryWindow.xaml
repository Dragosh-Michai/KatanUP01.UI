<Window x:Class="KatanUP01.UI.RequestHistoryWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="История выполнения заявок" 
        Height="500" Width="800"
        WindowStartupLocation="CenterOwner"
        Icon="Resources/icon.ico">

    <Grid Background="#F4E8D3">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Заголовок -->
        <Border Grid.Row="0" Background="White" Padding="10" Margin="5">
            <StackPanel>
                <TextBlock Text="История выполнения заявок" 
                           FontFamily="Segoe UI" 
                           FontSize="18" 
                           FontWeight="Bold"
                           Foreground="#333333"/>
                <TextBlock Text="Просмотр истории заявок по сотрудникам и адресам" 
                           FontFamily="Segoe UI" 
                           FontSize="12" 
                           Foreground="#666666"/>
            </StackPanel>
        </Border>

        <!-- Фильтры -->
        <Border Grid.Row="1" Background="White" Margin="5" Padding="10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Фильтр по сотруднику -->
                <TextBlock Grid.Column="0" Text="Сотрудник:" 
                           FontFamily="Segoe UI" FontSize="14"
                           VerticalAlignment="Center" Margin="0,0,10,0"/>
                <ComboBox x:Name="cbEmployeeFilter" Grid.Column="1" 
                          ItemsSource="{Binding Employees}"
                          DisplayMemberPath="FullName"
                          SelectedValue="{Binding SelectedEmployeeId}"
                          FontFamily="Segoe UI" FontSize="14"
                          Margin="0,0,20,0" Padding="5"/>

                <!-- Фильтр по адресу -->
                <TextBlock Grid.Column="2" Text="Адрес:" 
                           FontFamily="Segoe UI" FontSize="14"
                           VerticalAlignment="Center" Margin="0,0,10,0"/>
                <ComboBox x:Name="cbAddressFilter" Grid.Column="3" 
                          ItemsSource="{Binding Addresses}"
                          DisplayMemberPath="FullAddress"
                          SelectedValue="{Binding SelectedAddressId}"
                          FontFamily="Segoe UI" FontSize="14"
                          Margin="0,0,20,0" Padding="5"/>

                <!-- Кнопка фильтрации -->
                <Button Grid.Column="4" Content="Применить фильтр" 
                        Width="120" Height="35"
                        Background="#67BA80" Foreground="White"
                        FontFamily="Segoe UI" FontSize="14"
                        Click="BtnFilter_Click"/>
            </Grid>
        </Border>

        <!-- Список заявок -->
        <DataGrid x:Name="dgHistory" Grid.Row="2" Margin="5"
                  AutoGenerateColumns="False" 
                  CanUserAddRows="False"
                  Background="White"
                  BorderBrush="#CCCCCC"
                  FontFamily="Segoe UI"
                  FontSize="12">
            <DataGrid.Columns>
                <DataGridTextColumn Header="ID" Width="50" Binding="{Binding RequestId}"/>
                <DataGridTextColumn Header="Дата создания" Width="100" 
                                    Binding="{Binding CreatedDate, StringFormat=dd.MM.yyyy}"/>
                <DataGridTextColumn Header="Адрес" Width="150" 
                                    Binding="{Binding Address}"/>
                <DataGridTextColumn Header="Заявитель" Width="120" 
                                    Binding="{Binding ApplicantName}"/>
                <DataGridTextColumn Header="Описание" Width="200" 
                                    Binding="{Binding ProblemDescription}"/>
                <DataGridTextColumn Header="Исполнитель" Width="120" 
                                    Binding="{Binding EmployeeFullName}"/>
                <DataGridTextColumn Header="Статус" Width="80" 
                                    Binding="{Binding Status}"/>
                <DataGridTextColumn Header="Дата завершения" Width="100" 
                                    Binding="{Binding CompletionDate, StringFormat=dd.MM.yyyy}"/>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Статус бар -->
        <StatusBar Grid.Row="3" Background="White">
            <StatusBarItem>
                <TextBlock x:Name="tbStatus" Text="Готово" FontFamily="Segoe UI"/>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock x:Name="tbRecordCount" Text="Записей: 0" Margin="10,0" FontFamily="Segoe UI"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>